@import util._
@import views.html.common.page._
@import views.html.common.form._
@import views.html.common.state._
@import uk.gov.bis.lite.countryservice.api.CountryView
@import controllers.DestinationCountryController

@this(standardPage: standardPage)
@(form: Form[_], countries: List[CountryView], numberOfThroughDestinationCountries: Int, fieldOrderList: List[String])

@countryDetailPanel = {

  @detailPanel("destination-help"){
    I can't find my destination
  } {
    <h2 class="heading-medium">Need some help?</h2>
    If you can't find your destination country or territory you can get help from the government's Export Control organisation, by telephone on 020 7215 4594, or by email at <a href="mailto:eco.help@@trade.gsi.gov.uk">eco.help@@trade.gsi.gov.uk</a>.
  }

}

@standardPage("Finding the right licence", Some(heading("Where is the final destination of your items?"))){
  @errorSummary(form, fieldOrder = fieldOrderList)
} {

  <form action="@routes.DestinationCountryController.handleSubmit()" method="POST">

    @contextFormParams()

    @countrySelect(form(DestinationCountryController.FINAL_DESTINATION_COUNTRY_FIELD_NAME), countries, Some("Type your destination country or territory"), Some("form-hint"), None, Some(countryDetailPanel))

    @formRadioBoolean(form(DestinationCountryController.MULTIPLE_COUNTRIES), Html("Will your items be received by anyone in a different country or territory, such as a consignee, before reaching their final destination?"))

    <p class="js-hidden">
      <span class="bold-medium">If yes, please add the country below</span>
    </p>

    <div id="through-destination-countries-wrapper" class="js-hidden">
      @* Uncomment for multiple through destination countries
      @countrySelectGenerator(form, DestinationCountryController.THROUGH_DESTINATION_COUNTRIES_FIELD_NAME, numberOfThroughDestinationCountries, "Type the country or territory where the first consignee or other party will receive the items", countries)
      *@

      @countrySelect(form(DestinationCountryController.THROUGH_DESTINATION_COUNTRIES_FIELD_NAME + "[0]"), countries, Some("Type the country or territory where the first consignee or other party will receive the items"), None, None, None)

      @* Uncomment for multiple through destination countries
      @if(numberOfThroughDestinationCountries < DestinationCountryController.MAX_NUMBER_OF_THROUGH_COUNTRIES) {
        <div class="form-group">
          <button type="submit" class="link" role="link" name="addAnotherThroughDestination" value="true">Add another destination</button>
        </div>
      }
      *@

    </div>

    <div class="form-group">
      <button type="submit" class="button">Continue</button>
    </div>
  </form>

  <script type="text/javascript">
    $(document).ready(function(){LITEPermissionsFinder.DestinationCountry.setupPage()});
  </script>
}